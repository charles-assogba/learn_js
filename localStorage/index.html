<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>local storage</title>
  </head>
  <body>
    <section>
      <div class="container">
        <h1>local storage</h1>
        <input type="text" id="input" placeholder="Enter an task" />
        <button id="btnAdd">Add task</button>
        <ul class="list"></ul>
      </div>
    </section>
  </body>
  <script>
    let btnAdd = document.getElementById("btnAdd");
    btnAdd.addEventListener("click", () => {
      let task = input.value;
      if (task !== "") {
        addTask(task);
      }
    });
    //function for adding tasks
    const addTask = (task) => {
      let input = document.getElementById("input");
      let localData = JSON.parse(localStorage.getItem("localData")) || [];
      localData.push(input.value);
      localStorage.setItem("localData", JSON.stringify(localData));
      displayTask(task);
      input.value = "";
    };
    //function for displaying tasks
    const displayTask = (task) => {
      let list = document.querySelector(".list");
      list.innerHTML = "";
      let localData = JSON.parse(localStorage.getItem("localData")) || [];
      localData.forEach((task, index) => {
        let item = document.createElement("li");
        item.innerHTML = `
        <h2>${task}</h2>
        <button onClick='removeTask(${index})'>Remove</button>
        `;
        list.appendChild(item);
      });
    };
    //function for removing tasks
    const removeTask = (index) => {
      let localData = JSON.parse(localStorage.getItem("localData")) || [];
      localData.splice(index, 1);
      localStorage.setItem("localData", JSON.stringify(localData));
      displayTask();
    };
    displayTask();

    //json
    let data = {
      name: "charles",
      age: 23,
      city: "lome",
    };
    const a = JSON.parse(JSON.stringify(data));
    //console.log(a);

    //fetching data from URL
    /*
    fetch('https://jsonplaceholder.typicode.com/users')
    .then(response => response.json())
    .then(data => console.log(data))
    .catch(error => console.log('Error fetching data:', error));
    */
    //function to fetch data from URL
    async function getUsers() {
      try {
        //request to the server
        const response = await fetch(
          "https://jsonplaceholder.typicode.com/users",
        );
        //check if request succeeded before using the data
        if (!response.ok) throw new Error("Data could not be retrieved.");
        //getting the json data
        const data = await response.json();
        //loop to display of the json data
        data.forEach((element) => {
          //display the data in html element using DOM manipulation
          let emailItem = document.createElement("li");
          let list = document.querySelector(".list");
          emailItem.innerHTML = `
          <h2>Email: ${element.email}</h2>
          `;
          list.appendChild(emailItem);
        });
        //console.log(data);
      } catch (error) {
        console.log("Error:", error.message);
      }
    }
    getUsers();
  </script>
</html>
